"0","myfun <- function(c,n,alpha)"
"0","  pchisq(qchisq(pchisq(c,2*n)+1-alpha,2*n),2*n+2)-pchisq(c,2*n+2)-1+alpha"
"0",""
"0","mysolver <- function(n,alpha){"
"0","  a = qchisq(alpha/2,2*n)"
"0","  b = qchisq(alpha/2,2*n+2)"
"0","  ## solve the equation by using the root finding algorithm"
"0","  r = uniroot(myfun,n=n,alpha=alpha,interval = c(a,b))"
"0","  c1 = r$root"
"0","  c2 = qchisq(pchisq(c1,2*n)+1-alpha,2*n)"
"0","  err1 = pchisq(c2,2*n+2)-pchisq(c1,2*n+2)-1+alpha #check the error for eq. (2)"
"0","  ## the approximate method"
"0","  c11 = qchisq(alpha/2,2*n)"
"0","  c22 = qchisq(1-alpha/2,2*n)"
"0","  err2 = pchisq(c22,2*n+2)-pchisq(c11,2*n+2)-1+alpha #check the error for eq. (2)"
"0","  output = data.frame(exact=c(c1,c2,abs(err1)),rough=c(c11,c22,abs(err2)),"
"0","                      row.names = c(""C1"",""C2"",""error""))"
"0","  return(output)"
"0","}"
"0","alpha = 0.5"
"0","n = 10"
"0","output = mysolver(n,alpha)"
"0","knitr::kable(output,""html"",caption = ""n=10, alpha=0.05"")"
