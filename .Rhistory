col = c(rep("blue",11),rep("red",12)),
xlab = "fitted values",
ylab="standardized residuals")
abline(v=c(-2,2),lty=2)
plot(c(fitted(lm1),fitted(lm.xy)),c(rstandard(lm1),rstandard(lm.xy)),
ylim=c(-3,3),pch = c(rep(21,11),rep(22,12)),
col = c(rep("blue",11),rep("red",12)),
xlab = "fitted values",
ylab="standardized residuals")
abline(h=c(-2,2),lty=2)
par(mfrow = c(1,2),mar=c(4,4,1,1)+.1,oma=c(0,0,2,0))
plot(c(fitted(lm1),fitted(lm.xy)),c(rstandard(lm1),rstandard(lm.xy)),
ylim=c(-3,3),pch = c(rep(21,11),rep(22,12)),
col = c(rep("blue",11),rep("red",12)),
xlab = "fitted values",
ylab="standardized residuals")
abline(h=c(-2,2),lty=2)
plot(lm.xy,3)
par(mfrow = c(1,2),mar=c(4,4,1,1)+.1,oma=c(0,0,2,0))
plot(c(fitted(lm1),fitted(lm.xy)),c(rstandard(lm1),rstandard(lm.xy)),
ylim=c(-3,3),pch = c(rep(21,11),rep(22,12)),
col = c(rep("blue",11),rep("red",12)),
xlab = "fitted values",
ylab="standardized residuals")
abline(h=c(-2,2),lty=2)
plot(lm.xy,3,main="")
par(mfrow = c(1,2),mar=c(4,4,1,1)+.1,oma=c(0,0,2,0),main="")
plot(c(fitted(lm1),fitted(lm.xy)),c(rstandard(lm1),rstandard(lm.xy)),
ylim=c(-3,3),pch = c(rep(21,11),rep(22,12)),
col = c(rep("blue",11),rep("red",12)),
xlab = "fitted values",
ylab="standardized residuals")
abline(h=c(-2,2),lty=2)
plot(lm.xy,3)
par(mfrow = c(1,2),mar=c(4,4,1,1)+.1,oma=c(0,0,2,0))
plot(c(fitted(lm1),fitted(lm.xy)),c(rstandard(lm1),rstandard(lm.xy)),
ylim=c(-3,3),pch = c(rep(21,11),rep(22,12)),
col = c(rep("blue",11),rep("red",12)),
xlab = "fitted values",
ylab="standardized residuals",main="")
abline(h=c(-2,2),lty=2)
plot(lm.xy,3)
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
knitr::opts_chunk$set(echo = TRUE)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
plot(cbind(day,A,B))
cbind(day,A,B)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(cbind(day,A,B))
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B))
?matplot
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
lends <- c("Strain A","Strain B")
matplot(day,cbind(A,B),pch=1:2,ylab="population size", lend = lends)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
lends <- c("round","butt")
matplot(day,cbind(A,B),pch=1:2,ylab="population size", lend = lends)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
lends <- c("round","butt")
matplot(day,cbind(A,B),pch=1:2,ylab="population size", lend = lends)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size")
legend(0,400,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size")
legend(0,450,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size")
legend(0,450,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A))
summary(A)
summary(B)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size")
legend(0,450,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A))
summary(lm.A)
summary(lm.B)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size")
legend(0,450,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
summary(lm.A)
summary(lm.B)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size")
legend(0,450,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
abline(coef(lm.B),lty=2,col="red")
summary(lm.A)
summary(lm.B)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size")
legend(0,450,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"),ylim = c(100,500))
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size",ylim = c(100,500))
legend(0,450,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
abline(coef(lm.B),lty=2,col="red")
summary(lm.A)
summary(lm.B)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size",ylim = c(100,550))
legend(0,550,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
abline(coef(lm.B),lty=2,col="red")
summary(lm.A)
summary(lm.B)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size",ylim = c(100,550))
legend(0,550,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
abline(coef(lm.B),lty=2,col="red")
text(100,400,expression(y[A] = 145.3 + 0.742 x))
expression(y[A] = 145.3 + 0.742 x)
expression(y[A] == 145.3 + 0.742 x)
expression(y[A] == 145.3 + 0.742x)
exression(y[A])
exression("y[A]")
expression(y[A])
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size",ylim = c(100,550))
legend(0,550,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
abline(coef(lm.B),lty=2,col="red")
text(100,400,expression(y[A]))
summary(lm.A)
summary(lm.B)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size",ylim = c(100,550))
legend(0,550,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
abline(coef(lm.B),lty=2,col="red")
text(100,400,expression(y[A]==145.3))
summary(lm.A)
summary(lm.B)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size",ylim = c(100,550))
legend(0,550,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
abline(coef(lm.B),lty=2,col="red")
text(100,400,expression(y[A]==145.3+0.742x))
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size",ylim = c(100,550))
legend(0,550,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
abline(coef(lm.B),lty=2,col="red")
text(100,400,expression(y[A]==145.3+0.742 x))
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size",ylim = c(100,550))
legend(0,550,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
abline(coef(lm.B),lty=2,col="red")
text(100,400,expression(y[A]==145.3+0.742))
summary(lm.A)
summary(lm.B)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size",ylim = c(100,550))
legend(0,550,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
abline(coef(lm.B),lty=2,col="red")
text(100,400,expression(y[A]==145.3+0.742 x))
??expression
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size",ylim = c(100,550))
legend(0,550,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
abline(coef(lm.B),lty=2,col="red")
text(100,400,expression(y[A]==145.3+0.742 [x]))
summary(lm.A)
summary(lm.B)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size",ylim = c(100,550))
legend(0,550,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
abline(coef(lm.B),lty=2,col="red")
text(100,400,expression(y[A]==145.3+0.742 $a$))
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size",ylim = c(100,550))
legend(0,550,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
abline(coef(lm.B),lty=2,col="red")
text(100,400,expression(y[A]==145.3+0.742 hat(x) ))
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size",ylim = c(100,550))
legend(0,550,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
abline(coef(lm.B),lty=2,col="red")
text(100,400,expression(y[A]==145.3+0.742hat(x) ))
expression(y[A]==145.3+0.742hat(x) )
expression(y[A]==145.3+0.742x )
expression(y[A]==145.3+0.742 )
expression(y[A]==145.3 + 0.742 )
expression(y[A]==145.3 + 0.742 - x)
expression(y[A]==145.3 + 0.742  x)
expression(y[A]==145.3 + 0.742 * x)
expression(y[A]==145.3 + 0.742 %*% x)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size",ylim = c(100,550))
legend(0,550,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
abline(coef(lm.B),lty=2,col="red")
text(100,400,expression(y[A] == 145.3 + 0.742 %*% x))
summary(lm.A)
summary(lm.B)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size",ylim = c(100,550))
legend(0,550,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
abline(coef(lm.B),lty=2,col="red")
text(100,400,expression(y[A] == 145.3 + 0.742 * x))
summary(lm.A)
summary(lm.B)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size",ylim = c(100,550))
legend(0,550,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
abline(coef(lm.B),lty=2,col="red")
text(100,400,expression(y[A] == 145.3 + 0.742 * x))
text(250,200,expression(y[B] == 131.3 + 0.452 * x),col="red")
summary(lm.A)
summary(lm.B)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size",ylim = c(100,550))
legend(0,550,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
abline(coef(lm.B),lty=2,col="red")
text(100,400,expression(y[A] == 145.3 + 0.742 * x))
text(300,200,expression(y[B] == 131.3 + 0.452 * x),col="red")
summary(lm.A)
summary(lm.B)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size",ylim = c(100,550))
legend(0,550,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
abline(coef(lm.B),lty=2,col="red")
text(150,300,expression(y[A] == 145.3 + 0.742 * x))
text(300,200,expression(y[B] == 131.3 + 0.452 * x),col="red")
summary(lm.A)
summary(lm.B)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size",ylim = c(100,550))
legend(0,550,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
abline(coef(lm.B),lty=2,col="red")
text(140,300,expression(y[A] == 145.3 + 0.742 * x))
text(300,200,expression(y[B] == 131.3 + 0.452 * x),col="red")
summary(lm.A)
summary(lm.B)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size",ylim = c(100,550))
legend(0,550,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
abline(coef(lm.B),lty=2,col="red")
text(120,300,expression(y[A] == 145.3 + 0.742 * x))
text(300,200,expression(y[B] == 131.3 + 0.452 * x),col="red")
summary(lm.A)
summary(lm.B)
day = seq(0,500,by=100)
A = c(100,250,304,403,446,482)
B = c(100,203,214,295,330,324)
matplot(day,cbind(A,B),pch=1:2,ylab="population size",ylim = c(100,550))
legend(0,550,c("Strain A", "Strain B"),pch = 1:2,col=c("black","red"))
lm.A = lm(A~day)
lm.B = lm(B~day)
abline(coef(lm.A),lty=2)
abline(coef(lm.B),lty=2,col="red")
text(120,300,expression(hat(y)[A] == 145.3 + 0.742 * x))
text(300,200,expression(y[B] == 131.3 + 0.452 * x),col="red")
summary(lm.A)
summary(lm.B)
lm.A$coefficients
summary(lm.A)$coef
output = c(summary(lm.A)$coef,summary(lm.B)$coef)
output
summary(lm.A)$coef
output = list(summary(lm.A)$coef,summary(lm.B)$coef)
output
output = list(summary(lm.A)$coef,summary(lm.B)$coef)
data.frame(unlist(output))
data.frame(output)
rbind(summary(lm.A)$coef,summary(lm.B)$coef)
day
var(day)*5
5512.14+3960.14
14/sqrt(9472.28/4/175000)
(0.7420	-0.4520)/sqrt(9472.28/4/175000)
qt(0.95,8)
bookdown
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE)
blood=data.frame(
weight=c(76.0,91.5,85.5,82.5,79.0,80.5,74.5,79.0,85.0,76.5,82.0,95.0,92.5),
age=c(50,20,20,30,30,50,60,50,40,55,40,40,20),
pressure=c(120,141,124,126,117,125,123,125,132,123,132,155,147))
plot(blood)
n = length(blood$weight)
X = cbind(intercept=rep(1,n),weight=blood$weight,age=blood$age)
C = solve(t(X)%*%X)
SSE = sum(lm.blood$residuals^2) # sum of squared errors
lm.blood=lm(pressure~weight+age,data=blood)
summary(lm.blood)
n = length(blood$weight)
X = cbind(intercept=rep(1,n),weight=blood$weight,age=blood$age)
C = solve(t(X)%*%X)
SSE = sum(lm.blood$residuals^2) # sum of squared errors
# SST = var(blood$pressure)*(n-1)
# SSR = SST-SSE
# Fstat = SSR/(3-1)/(SSE/(n-3))
cov = SSE/(n-3)*C
knitr::kable(cov,caption = "")
newdata = data.frame(
age = rep(31,100),
weight = seq(70,100,length.out = 100)
)
CI = predict(lm.blood,newdata,interval = "confidence")
Pred = predict(lm.blood,newdata,interval = "prediction")
par(mar=c(4,4,2,1))
matplot(newdata$weight,cbind(CI,Pred[,-1]),type="l",lty = c(1,5,5,2,2),
col=c("blue","red","red","brown","brown"),lwd=2,
xlab="Weight",ylab="Pressure",main = "Age = 31")
legend(70,160,c("Fitted","Confidence","Prediction"),
lty = c(1,5,2),col=c("blue","red","brown"))
coef.list = list()
for(i in 1:4)
{
ff = as.formula(paste0("y",i,"~","x",i))
lmi = lm(ff,data = anscombe)
coef.list = c(coef.list, list(summary(lmi)$coef))
}
print(coef.list)
par(mfrow = c(2,2),mar=c(4,4,1,1)+.1,oma=c(0,0,2,0))
for(i in 1:4)
{
ff = as.formula(paste0("y",i,"~","x",i))
lmi = lm(ff,data = anscombe)
plot(ff,data = anscombe,col="red",pch = 21,bg="orange",
cex = 1.2,xlim=c(3,19),ylim=c(3,13))
abline(coef(lmi),col="blue")
}
lm1 = lm(y1~x1,data = anscombe)
x = c(anscombe$x1, 18)
y = c(anscombe$y1,30)
lm.xy = lm(y~x)
plot(x,y,pch = 21,bg=c(rep("black",11),"red"),ylim=c(0,50))
abline(coef(lm.xy),lty=2,col="red")
abline(coef(lm1),lty=2,col="blue")
par(mfrow = c(1,2),mar=c(4,4,1,1)+.1,oma=c(0,0,2,0))
plot(c(fitted(lm1),fitted(lm.xy)),c(rstandard(lm1),rstandard(lm.xy)),
ylim=c(-3,3),pch = c(rep(21,11),rep(22,12)),
bg = c(rep("blue",11),rep("red",12)),
xlab = "fitted values",
ylab="standardized residuals")
abline(h=c(-2,2),lty=2)
plot(lm.xy,3)
plot(lm.blood)
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE)
blood=data.frame(
weight=c(76.0,91.5,85.5,82.5,79.0,80.5,74.5,79.0,85.0,76.5,82.0,95.0,92.5),
age=c(50,20,20,30,30,50,60,50,40,55,40,40,20),
pressure=c(120,141,124,126,117,125,123,125,132,123,132,155,147))
plot(blood)
lm.blood=lm(pressure~weight+age,data=blood)
summary(lm.blood)
blood=data.frame(
weight=c(76.0,91.5,85.5,82.5,79.0,80.5,74.5,79.0,85.0,76.5,82.0,95.0,92.5),
age=c(50,20,20,30,30,50,60,50,40,55,40,40,20),
pressure=c(120,141,124,126,117,125,123,125,132,123,132,155,147))
plot(blood)
lm.blood=lm(pressure~weight+age,data=blood)
summary(lm.blood)
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
